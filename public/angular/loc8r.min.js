(function(){angular.module("loc8rApp",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e){e.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"/common/views/genericText.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/location/:locationid",{templateUrl:"/locationDetail/locationDetail.view.html",controller:"locationDetailCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}angular.module("loc8rApp").config(["$routeProvider",e])})();(function(){angular.module("loc8rApp").controller("homeCtrl",e);e.$inject=["$scope","loc8rData","geolocation"];function e(e,o,t){var r=this;r.pageHeader={title:"Loc8r",strapline:"Find places to work with wifi near you!"};r.sidebar={content:"Looking for wifi and a seat? Loc8r helps you find places to work when out and about. Perhaps with coffee, cake or a pint? Let Loc8r help you find the place you're looking for."};r.message="Checking your location";r.getData=function(e){var t=e.coords.latitude,n=e.coords.longitude;r.message="Searching for nearby places";o.locationByCoords(t,n).success(function(e){r.message=e.length>0?"":"No locations found";r.data={locations:e}}).error(function(e){console.log(e);r.message="Sorry, something's gone wrong"})};r.showError=function(o){e.$apply(function(){r.message=o.message})};r.noGeo=function(){e.$apply(function(){r.message="Geolocation is not supported by your browser"})};t.getPosition(r.getData,r.showError,r.noGeo)}})();(function(){angular.module("loc8rApp").controller("aboutCtrl",e);function e(){var e=this;e.pageHeader={title:"About Loc8r"};e.main={content:"Loc8r was created to help people find places to sit down and get a bit of work done.\n\nRoof party banjo pickled polaroid. Sriracha meditation ennui street art typewriter, kickstarter vice man bun. Literally master cleanse swag, blog occupy dreamcatcher locavore XOXO tofu ramps. Banjo waistcoat letterpress chartreuse +1 kinfolk meditation. \n\nBitters squid tote bag, lo-fi tacos swag fingerstache helvetica stumptown microdosing meditation. Kombucha aesthetic tote bag chartreuse flexitarian chia, put a bird on it echo park synth sartorial fingerstache sustainable butcher art party. Slow-carb selvage chartreuse, distillery neutra letterpress man braid williamsburg master cleanse."}}})();(function(){angular.module("loc8rApp").controller("locationDetailCtrl",e);e.$inject=["$routeParams","$modal","loc8rData"];function e(e,o,t){var r=this;r.locationid=e.locationid;t.locationById(r.locationid).success(function(e){r.data={location:e};r.pageHeader={title:r.data.location.name}}).error(function(e){console.log(e)});r.popupReviewForm=function(){var e=o.open({templateUrl:"/reviewModal/reviewModal.view.html",controller:"reviewModalCtrl as vm",resolve:{locationData:function(){return{locationid:r.locationid,locationName:r.data.location.name}}}});e.result.then(function(e){r.data.location.reviews.push(e)})}}})();(function(){angular.module("loc8rApp").controller("reviewModalCtrl",e);e.$inject=["$modalInstance","loc8rData","locationData"];function e(e,o,t){var r=this;r.locationData=t;r.onSubmit=function(){r.formError="";if(!r.formData.name||!r.formData.rating||!r.formData.reviewText){r.formError="All fields required, please try again";return false}else{r.doAddReview(r.locationData.locationid,r.formData)}};r.doAddReview=function(e,t){o.addReviewById(e,{author:t.name,rating:t.rating,reviewText:t.reviewText}).success(function(e){r.modal.close(e)}).error(function(e){r.formError="Your review has not been saved, please try again"});return false};r.modal={close:function(o){e.close(o)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("loc8rApp").service("geolocation",e);function e(){var e=function(e,o,t){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(e,o)}else{t()}};return{getPosition:e}}})();(function(){angular.module("loc8rApp").service("loc8rData",e);e.$inject=["$http"];function e(e){var o=function(o,t){return e.get("/api/locations?lng="+t+"&lat="+o+"&maxDistance=30")};var t=function(o){return e.get("/api/locations/"+o)};var r=function(o,t){return e.post("/api/locations/"+o+"/reviews",t)};return{locationByCoords:o,locationById:t,addReviewById:r}}})();(function(){angular.module("loc8rApp").filter("formatDistance",o);var e=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};function o(){return function(o){var t,r;if(o&&e(o)){if(o>1){t=parseFloat(o).toFixed(1);r="km"}else{t=parseInt(o*1e3,10);r="m"}return t+r}else{return"?"}}}})();(function(){angular.module("loc8rApp").directive("ratingStars",e);function e(){return{restrict:"EA",scope:{thisRating:"=rating"},templateUrl:"/common/directives/ratingStars/ratingStars.template.html"}}})();(function(){angular.module("loc8rApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("loc8rApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("loc8rApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("loc8rApp").filter("addHtmlLineBreaks",e);function e(){return function(e){var o=e.replace(/\n/g,"<br/>");return o}}})();